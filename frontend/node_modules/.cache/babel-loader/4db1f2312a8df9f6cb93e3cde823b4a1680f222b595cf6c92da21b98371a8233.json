{"ast":null,"code":"// // // // // const API = (path, opts={}) => {\n// // // // //   const base = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\n// // // // //   const headers = opts.headers || {};\n// // // // //   const token = localStorage.getItem('token');\n// // // // //   if (token) headers['Authorization'] = 'Bearer ' + token;\n// // // // //   return fetch(base + path, {...opts, headers}).then(r=>r.json());\n// // // // // };\n// // // // // export default API;\n// // // // // const API = async (url, options = {}) => {\n// // // // //   const res = await fetch(`${process.env.REACT_APP_API_URL}/items`, options);\n// // // // //   return await res.json();\n// // // // // };\n\n// // // // // export default API;\n// // // // const API_BASE = \"http://localhost:5000/api\"; // hardcoded for debug\n\n// // // // //const API_BASE = process.env.REACT_APP_API_URL || \"http://localhost:5000/api\";\n\n// // // // /**\n// // // //  * API(path, options)\n// // // //  * - path starts with '/items' or '/cart' or '/users/...' (no /api prefix)\n// // // //  * - options: fetch init (method, headers, body)\n// // // //  */\n// // // // export default async function API(path, options = {}) {\n// // // //   const url = `${API_BASE}${path}`;\n// // // //   const headers = {\n// // // //     \"Content-Type\": \"application/json\",\n// // // //     ...(options.headers || {}),\n// // // //   };\n\n// // // //   // keep token automatically (if present)\n// // // //   if (!headers.Authorization) {\n// // // //     const token = localStorage.getItem(\"token\");\n// // // //     if (token) headers.Authorization = `Bearer ${token}`;\n// // // //   }\n\n// // // //   const fetchOpts = { headers, ...options };\n// // // //   try {\n// // // //     const res = await fetch(url, fetchOpts);\n// // // //     // if server returns not-json (HTML error) throw with text\n// // // //     const text = await res.text();\n// // // //     try {\n// // // //       const json = JSON.parse(text || \"{}\");\n// // // //       if (!res.ok) throw new Error(json.message || `Server error ${res.status}`);\n// // // //       return json;\n// // // //     } catch {\n// // // //       // not json\n// // // //       if (!res.ok) throw new Error(text || `Server error ${res.status}`);\n// // // //       // if ok but not json return text\n// // // //       return text;\n// // // //     }\n// // // //   } catch (err) {\n// // // //     console.error(\"API error:\", err);\n// // // //     throw err;\n// // // //   }\n// // // // }\n\n// // // // ‚úÖ frontend/src/api.js\n// // // const API_BASE = (process.env.REACT_APP_API_URL || \"http://localhost:5000/api\").replace(/\\/+$/, \"\");\n\n// // // export default async function API(path, options = {}) {\n// // //   // Always prefix with /api\n// // //   const endpoint = path.startsWith(\"/api\") ? path : path.startsWith(\"/\") ? `/api${path}` : `/api/${path}`;\n// // //   const url = `${API_BASE}${endpoint.replace(\"/api/api\", \"/api\")}`;\n\n// // //   const headers = {\n// // //     \"Content-Type\": \"application/json\",\n// // //     ...(options.headers || {}),\n// // //   };\n\n// // //   const token = localStorage.getItem(\"token\");\n// // //   if (token && !headers.Authorization) {\n// // //     headers.Authorization = `Bearer ${token}`;\n// // //   }\n\n// // //   console.log(\"üåê API Request:\", url); // üëà helpful debug log\n\n// // //   try {\n// // //     const res = await fetch(url, { ...options, headers });\n// // //     const text = await res.text();\n\n// // //     try {\n// // //       const data = JSON.parse(text);\n// // //       if (!res.ok) throw new Error(data.message || `HTTP ${res.status}`);\n// // //       return data;\n// // //     } catch {\n// // //       throw new Error(`Server error ${res.status}: ${text}`);\n// // //     }\n// // //   } catch (err) {\n// // //     console.error(\"‚ùå API error:\", err);\n// // //     throw err;\n// // //   }\n// // // }\n// // // ‚úÖ frontend/src/api.js (final version)\n// // const API_BASE = (process.env.REACT_APP_API_URL || \"http://localhost:5000/api\").replace(/\\/+$/, \"\");\n\n// // export default async function API(path, options = {}) {\n// //   // ‚úÖ Normalize: ensure exactly one \"/api\" in path\n// //   let endpoint = path.startsWith(\"/api\") ? path : `/api${path.startsWith(\"/\") ? path : `/${path}`}`;\n// //   endpoint = endpoint.replace(/\\/api\\/api/g, \"/api\"); // fix accidental double prefix\n\n// //   const url = `${API_BASE}${endpoint.replace(API_BASE, \"\")}`; // safe join\n\n// //   const headers = {\n// //     \"Content-Type\": \"application/json\",\n// //     ...(options.headers || {}),\n// //   };\n\n// //   const token = localStorage.getItem(\"token\");\n// //   if (token && !headers.Authorization) {\n// //     headers.Authorization = `Bearer ${token}`;\n// //   }\n\n// //   console.log(\"üåê API Request:\", url); // debug log\n\n// //   try {\n// //     const res = await fetch(url, { ...options, headers });\n// //     const text = await res.text();\n\n// //     try {\n// //       const data = JSON.parse(text);\n// //       if (!res.ok) throw new Error(data.message || `HTTP ${res.status}`);\n// //       return data;\n// //     } catch {\n// //       throw new Error(`Server error ${res.status}: ${text}`);\n// //     }\n// //   } catch (err) {\n// //     console.error(\"‚ùå API error:\", err);\n// //     throw err;\n// //   }\n// // }\n// // ‚úÖ Final working version\n// const API_BASE = (process.env.REACT_APP_API_URL || \"http://localhost:5000\")\n//   .replace(/\\/+$/, \"\"); // remove trailing slashes\n\n// export default async function API(path, options = {}) {\n//   // ‚úÖ Always ensure exactly one /api in final URL\n//   let endpoint = path.startsWith(\"/\") ? path : `/${path}`;\n//   if (!endpoint.startsWith(\"/api\")) endpoint = `/api${endpoint}`;\n\n//   const url = `${API_BASE}${endpoint}`; // e.g. http://localhost:5000/api/items\n//   console.log(\"üåê Final API URL:\", url);\n\n//   const headers = {\n//     \"Content-Type\": \"application/json\",\n//     ...(options.headers || {}),\n//   };\n\n//   const token = localStorage.getItem(\"token\");\n//   if (token) headers.Authorization = `Bearer ${token}`;\n\n//   try {\n//     const res = await fetch(url, { ...options, headers });\n//     const text = await res.text();\n\n//     try {\n//       const data = JSON.parse(text);\n//       if (!res.ok) throw new Error(data.message || `HTTP ${res.status}`);\n//       return data;\n//     } catch {\n//       throw new Error(`Server error ${res.status}: ${text}`);\n//     }\n//   } catch (err) {\n//     console.error(\"‚ùå API error:\", err);\n//     throw err;\n//   }\n// }\n// ‚úÖ frontend/src/api.js (bulletproof final version)\nlet API_BASE = process.env.REACT_APP_API_URL || \"http://localhost:5000\";\nAPI_BASE = API_BASE.replace(/\\/+$/, \"\"); // remove trailing slashes\n\n// Remove trailing '/api' if already present\nAPI_BASE = API_BASE.replace(/\\/api$/, \"\");\nconsole.log(\"üîç API Base URL =\", API_BASE);\nexport default async function API(path, options = {}) {\n  // Normalize path\n  let endpoint = path.startsWith(\"/\") ? path : `/${path}`;\n  if (!endpoint.startsWith(\"/api\")) endpoint = `/api${endpoint}`;\n  const url = `${API_BASE}${endpoint}`;\n  console.log(\"üåê Final API URL:\", url);\n\n  // Headers\n  const headers = {\n    \"Content-Type\": \"application/json\",\n    ...(options.headers || {})\n  };\n  const token = localStorage.getItem(\"token\");\n  if (token && !headers.Authorization) {\n    headers.Authorization = `Bearer ${token}`;\n  }\n  try {\n    const res = await fetch(url, {\n      ...options,\n      headers\n    });\n    const text = await res.text();\n\n    // Handle HTML responses (errors)\n    if (text.startsWith(\"<!DOCTYPE\") || text.startsWith(\"<html\")) {\n      throw new Error(`Server error ${res.status}: Received HTML instead of JSON`);\n    }\n    const data = JSON.parse(text);\n    if (!res.ok) throw new Error(data.message || `HTTP ${res.status}`);\n    return data;\n  } catch (err) {\n    console.error(\"‚ùå API error:\", err);\n    throw err;\n  }\n}\n_c = API;\nvar _c;\n$RefreshReg$(_c, \"API\");","map":{"version":3,"names":["API_BASE","process","env","REACT_APP_API_URL","replace","console","log","API","path","options","endpoint","startsWith","url","headers","token","localStorage","getItem","Authorization","res","fetch","text","Error","status","data","JSON","parse","ok","message","err","error","_c","$RefreshReg$"],"sources":["C:/Users/Admin/Desktop/Web Development/Projects/zwigato/frontend/src/api.js"],"sourcesContent":["// // // // // const API = (path, opts={}) => {\n// // // // //   const base = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\n// // // // //   const headers = opts.headers || {};\n// // // // //   const token = localStorage.getItem('token');\n// // // // //   if (token) headers['Authorization'] = 'Bearer ' + token;\n// // // // //   return fetch(base + path, {...opts, headers}).then(r=>r.json());\n// // // // // };\n// // // // // export default API;\n// // // // // const API = async (url, options = {}) => {\n// // // // //   const res = await fetch(`${process.env.REACT_APP_API_URL}/items`, options);\n// // // // //   return await res.json();\n// // // // // };\n\n// // // // // export default API;\n// // // // const API_BASE = \"http://localhost:5000/api\"; // hardcoded for debug\n\n// // // // //const API_BASE = process.env.REACT_APP_API_URL || \"http://localhost:5000/api\";\n\n// // // // /**\n// // // //  * API(path, options)\n// // // //  * - path starts with '/items' or '/cart' or '/users/...' (no /api prefix)\n// // // //  * - options: fetch init (method, headers, body)\n// // // //  */\n// // // // export default async function API(path, options = {}) {\n// // // //   const url = `${API_BASE}${path}`;\n// // // //   const headers = {\n// // // //     \"Content-Type\": \"application/json\",\n// // // //     ...(options.headers || {}),\n// // // //   };\n\n// // // //   // keep token automatically (if present)\n// // // //   if (!headers.Authorization) {\n// // // //     const token = localStorage.getItem(\"token\");\n// // // //     if (token) headers.Authorization = `Bearer ${token}`;\n// // // //   }\n\n// // // //   const fetchOpts = { headers, ...options };\n// // // //   try {\n// // // //     const res = await fetch(url, fetchOpts);\n// // // //     // if server returns not-json (HTML error) throw with text\n// // // //     const text = await res.text();\n// // // //     try {\n// // // //       const json = JSON.parse(text || \"{}\");\n// // // //       if (!res.ok) throw new Error(json.message || `Server error ${res.status}`);\n// // // //       return json;\n// // // //     } catch {\n// // // //       // not json\n// // // //       if (!res.ok) throw new Error(text || `Server error ${res.status}`);\n// // // //       // if ok but not json return text\n// // // //       return text;\n// // // //     }\n// // // //   } catch (err) {\n// // // //     console.error(\"API error:\", err);\n// // // //     throw err;\n// // // //   }\n// // // // }\n\n// // // // ‚úÖ frontend/src/api.js\n// // // const API_BASE = (process.env.REACT_APP_API_URL || \"http://localhost:5000/api\").replace(/\\/+$/, \"\");\n\n// // // export default async function API(path, options = {}) {\n// // //   // Always prefix with /api\n// // //   const endpoint = path.startsWith(\"/api\") ? path : path.startsWith(\"/\") ? `/api${path}` : `/api/${path}`;\n// // //   const url = `${API_BASE}${endpoint.replace(\"/api/api\", \"/api\")}`;\n\n// // //   const headers = {\n// // //     \"Content-Type\": \"application/json\",\n// // //     ...(options.headers || {}),\n// // //   };\n\n// // //   const token = localStorage.getItem(\"token\");\n// // //   if (token && !headers.Authorization) {\n// // //     headers.Authorization = `Bearer ${token}`;\n// // //   }\n\n// // //   console.log(\"üåê API Request:\", url); // üëà helpful debug log\n\n// // //   try {\n// // //     const res = await fetch(url, { ...options, headers });\n// // //     const text = await res.text();\n\n// // //     try {\n// // //       const data = JSON.parse(text);\n// // //       if (!res.ok) throw new Error(data.message || `HTTP ${res.status}`);\n// // //       return data;\n// // //     } catch {\n// // //       throw new Error(`Server error ${res.status}: ${text}`);\n// // //     }\n// // //   } catch (err) {\n// // //     console.error(\"‚ùå API error:\", err);\n// // //     throw err;\n// // //   }\n// // // }\n// // // ‚úÖ frontend/src/api.js (final version)\n// // const API_BASE = (process.env.REACT_APP_API_URL || \"http://localhost:5000/api\").replace(/\\/+$/, \"\");\n\n// // export default async function API(path, options = {}) {\n// //   // ‚úÖ Normalize: ensure exactly one \"/api\" in path\n// //   let endpoint = path.startsWith(\"/api\") ? path : `/api${path.startsWith(\"/\") ? path : `/${path}`}`;\n// //   endpoint = endpoint.replace(/\\/api\\/api/g, \"/api\"); // fix accidental double prefix\n\n// //   const url = `${API_BASE}${endpoint.replace(API_BASE, \"\")}`; // safe join\n\n// //   const headers = {\n// //     \"Content-Type\": \"application/json\",\n// //     ...(options.headers || {}),\n// //   };\n\n// //   const token = localStorage.getItem(\"token\");\n// //   if (token && !headers.Authorization) {\n// //     headers.Authorization = `Bearer ${token}`;\n// //   }\n\n// //   console.log(\"üåê API Request:\", url); // debug log\n\n// //   try {\n// //     const res = await fetch(url, { ...options, headers });\n// //     const text = await res.text();\n\n// //     try {\n// //       const data = JSON.parse(text);\n// //       if (!res.ok) throw new Error(data.message || `HTTP ${res.status}`);\n// //       return data;\n// //     } catch {\n// //       throw new Error(`Server error ${res.status}: ${text}`);\n// //     }\n// //   } catch (err) {\n// //     console.error(\"‚ùå API error:\", err);\n// //     throw err;\n// //   }\n// // }\n// // ‚úÖ Final working version\n// const API_BASE = (process.env.REACT_APP_API_URL || \"http://localhost:5000\")\n//   .replace(/\\/+$/, \"\"); // remove trailing slashes\n\n// export default async function API(path, options = {}) {\n//   // ‚úÖ Always ensure exactly one /api in final URL\n//   let endpoint = path.startsWith(\"/\") ? path : `/${path}`;\n//   if (!endpoint.startsWith(\"/api\")) endpoint = `/api${endpoint}`;\n\n//   const url = `${API_BASE}${endpoint}`; // e.g. http://localhost:5000/api/items\n//   console.log(\"üåê Final API URL:\", url);\n\n//   const headers = {\n//     \"Content-Type\": \"application/json\",\n//     ...(options.headers || {}),\n//   };\n\n//   const token = localStorage.getItem(\"token\");\n//   if (token) headers.Authorization = `Bearer ${token}`;\n\n//   try {\n//     const res = await fetch(url, { ...options, headers });\n//     const text = await res.text();\n\n//     try {\n//       const data = JSON.parse(text);\n//       if (!res.ok) throw new Error(data.message || `HTTP ${res.status}`);\n//       return data;\n//     } catch {\n//       throw new Error(`Server error ${res.status}: ${text}`);\n//     }\n//   } catch (err) {\n//     console.error(\"‚ùå API error:\", err);\n//     throw err;\n//   }\n// }\n// ‚úÖ frontend/src/api.js (bulletproof final version)\nlet API_BASE = process.env.REACT_APP_API_URL || \"http://localhost:5000\";\nAPI_BASE = API_BASE.replace(/\\/+$/, \"\"); // remove trailing slashes\n\n// Remove trailing '/api' if already present\nAPI_BASE = API_BASE.replace(/\\/api$/, \"\");\n\nconsole.log(\"üîç API Base URL =\", API_BASE);\n\nexport default async function API(path, options = {}) {\n  // Normalize path\n  let endpoint = path.startsWith(\"/\") ? path : `/${path}`;\n  if (!endpoint.startsWith(\"/api\")) endpoint = `/api${endpoint}`;\n\n  const url = `${API_BASE}${endpoint}`;\n  console.log(\"üåê Final API URL:\", url);\n\n  // Headers\n  const headers = {\n    \"Content-Type\": \"application/json\",\n    ...(options.headers || {}),\n  };\n\n  const token = localStorage.getItem(\"token\");\n  if (token && !headers.Authorization) {\n    headers.Authorization = `Bearer ${token}`;\n  }\n\n  try {\n    const res = await fetch(url, { ...options, headers });\n    const text = await res.text();\n\n    // Handle HTML responses (errors)\n    if (text.startsWith(\"<!DOCTYPE\") || text.startsWith(\"<html\")) {\n      throw new Error(`Server error ${res.status}: Received HTML instead of JSON`);\n    }\n\n    const data = JSON.parse(text);\n    if (!res.ok) throw new Error(data.message || `HTTP ${res.status}`);\n\n    return data;\n  } catch (err) {\n    console.error(\"‚ùå API error:\", err);\n    throw err;\n  }\n}\n\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAIA,QAAQ,GAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,IAAI,uBAAuB;AACvEH,QAAQ,GAAGA,QAAQ,CAACI,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC,CAAC;;AAEzC;AACAJ,QAAQ,GAAGA,QAAQ,CAACI,OAAO,CAAC,QAAQ,EAAE,EAAE,CAAC;AAEzCC,OAAO,CAACC,GAAG,CAAC,mBAAmB,EAAEN,QAAQ,CAAC;AAE1C,eAAe,eAAeO,GAAGA,CAACC,IAAI,EAAEC,OAAO,GAAG,CAAC,CAAC,EAAE;EACpD;EACA,IAAIC,QAAQ,GAAGF,IAAI,CAACG,UAAU,CAAC,GAAG,CAAC,GAAGH,IAAI,GAAG,IAAIA,IAAI,EAAE;EACvD,IAAI,CAACE,QAAQ,CAACC,UAAU,CAAC,MAAM,CAAC,EAAED,QAAQ,GAAG,OAAOA,QAAQ,EAAE;EAE9D,MAAME,GAAG,GAAG,GAAGZ,QAAQ,GAAGU,QAAQ,EAAE;EACpCL,OAAO,CAACC,GAAG,CAAC,mBAAmB,EAAEM,GAAG,CAAC;;EAErC;EACA,MAAMC,OAAO,GAAG;IACd,cAAc,EAAE,kBAAkB;IAClC,IAAIJ,OAAO,CAACI,OAAO,IAAI,CAAC,CAAC;EAC3B,CAAC;EAED,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;EAC3C,IAAIF,KAAK,IAAI,CAACD,OAAO,CAACI,aAAa,EAAE;IACnCJ,OAAO,CAACI,aAAa,GAAG,UAAUH,KAAK,EAAE;EAC3C;EAEA,IAAI;IACF,MAAMI,GAAG,GAAG,MAAMC,KAAK,CAACP,GAAG,EAAE;MAAE,GAAGH,OAAO;MAAEI;IAAQ,CAAC,CAAC;IACrD,MAAMO,IAAI,GAAG,MAAMF,GAAG,CAACE,IAAI,CAAC,CAAC;;IAE7B;IACA,IAAIA,IAAI,CAACT,UAAU,CAAC,WAAW,CAAC,IAAIS,IAAI,CAACT,UAAU,CAAC,OAAO,CAAC,EAAE;MAC5D,MAAM,IAAIU,KAAK,CAAC,gBAAgBH,GAAG,CAACI,MAAM,iCAAiC,CAAC;IAC9E;IAEA,MAAMC,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACL,IAAI,CAAC;IAC7B,IAAI,CAACF,GAAG,CAACQ,EAAE,EAAE,MAAM,IAAIL,KAAK,CAACE,IAAI,CAACI,OAAO,IAAI,QAAQT,GAAG,CAACI,MAAM,EAAE,CAAC;IAElE,OAAOC,IAAI;EACb,CAAC,CAAC,OAAOK,GAAG,EAAE;IACZvB,OAAO,CAACwB,KAAK,CAAC,cAAc,EAAED,GAAG,CAAC;IAClC,MAAMA,GAAG;EACX;AACF;AAACE,EAAA,GApC6BvB,GAAG;AAAA,IAAAuB,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}