{"ast":null,"code":"// // const API = (path, opts={}) => {\n// //   const base = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\n// //   const headers = opts.headers || {};\n// //   const token = localStorage.getItem('token');\n// //   if (token) headers['Authorization'] = 'Bearer ' + token;\n// //   return fetch(base + path, {...opts, headers}).then(r=>r.json());\n// // };\n// // export default API;\n// // const API = async (url, options = {}) => {\n// //   const res = await fetch(`${process.env.REACT_APP_API_URL}/items`, options);\n// //   return await res.json();\n// // };\n\n// // export default API;\n// const API_BASE = \"http://localhost:5000/api\"; // hardcoded for debug\n\n// //const API_BASE = process.env.REACT_APP_API_URL || \"http://localhost:5000/api\";\n\n// /**\n//  * API(path, options)\n//  * - path starts with '/items' or '/cart' or '/users/...' (no /api prefix)\n//  * - options: fetch init (method, headers, body)\n//  */\n// export default async function API(path, options = {}) {\n//   const url = `${API_BASE}${path}`;\n//   const headers = {\n//     \"Content-Type\": \"application/json\",\n//     ...(options.headers || {}),\n//   };\n\n//   // keep token automatically (if present)\n//   if (!headers.Authorization) {\n//     const token = localStorage.getItem(\"token\");\n//     if (token) headers.Authorization = `Bearer ${token}`;\n//   }\n\n//   const fetchOpts = { headers, ...options };\n//   try {\n//     const res = await fetch(url, fetchOpts);\n//     // if server returns not-json (HTML error) throw with text\n//     const text = await res.text();\n//     try {\n//       const json = JSON.parse(text || \"{}\");\n//       if (!res.ok) throw new Error(json.message || `Server error ${res.status}`);\n//       return json;\n//     } catch {\n//       // not json\n//       if (!res.ok) throw new Error(text || `Server error ${res.status}`);\n//       // if ok but not json return text\n//       return text;\n//     }\n//   } catch (err) {\n//     console.error(\"API error:\", err);\n//     throw err;\n//   }\n// }\n\n// ‚úÖ frontend/src/api.js\nconst API_BASE = (process.env.REACT_APP_API_URL || \"http://localhost:5000/api\").replace(/\\/+$/, \"\");\nexport default async function API(path, options = {}) {\n  // Always prefix with /api\n  const endpoint = path.startsWith(\"/api\") ? path : path.startsWith(\"/\") ? `/api${path}` : `/api/${path}`;\n  const url = `${API_BASE}${endpoint.replace(\"/api/api\", \"/api\")}`;\n  const headers = {\n    \"Content-Type\": \"application/json\",\n    ...(options.headers || {})\n  };\n  const token = localStorage.getItem(\"token\");\n  if (token && !headers.Authorization) {\n    headers.Authorization = `Bearer ${token}`;\n  }\n  console.log(\"üåê API Request:\", url); // üëà helpful debug log\n\n  try {\n    const res = await fetch(url, {\n      ...options,\n      headers\n    });\n    const text = await res.text();\n    try {\n      const data = JSON.parse(text);\n      if (!res.ok) throw new Error(data.message || `HTTP ${res.status}`);\n      return data;\n    } catch {\n      throw new Error(`Server error ${res.status}: ${text}`);\n    }\n  } catch (err) {\n    console.error(\"‚ùå API error:\", err);\n    throw err;\n  }\n}\n_c = API;\nvar _c;\n$RefreshReg$(_c, \"API\");","map":{"version":3,"names":["API_BASE","process","env","REACT_APP_API_URL","replace","API","path","options","endpoint","startsWith","url","headers","token","localStorage","getItem","Authorization","console","log","res","fetch","text","data","JSON","parse","ok","Error","message","status","err","error","_c","$RefreshReg$"],"sources":["C:/Users/Admin/Desktop/Web Development/Projects/zwigato/frontend/src/api.js"],"sourcesContent":["// // const API = (path, opts={}) => {\n// //   const base = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\n// //   const headers = opts.headers || {};\n// //   const token = localStorage.getItem('token');\n// //   if (token) headers['Authorization'] = 'Bearer ' + token;\n// //   return fetch(base + path, {...opts, headers}).then(r=>r.json());\n// // };\n// // export default API;\n// // const API = async (url, options = {}) => {\n// //   const res = await fetch(`${process.env.REACT_APP_API_URL}/items`, options);\n// //   return await res.json();\n// // };\n\n// // export default API;\n// const API_BASE = \"http://localhost:5000/api\"; // hardcoded for debug\n\n// //const API_BASE = process.env.REACT_APP_API_URL || \"http://localhost:5000/api\";\n\n// /**\n//  * API(path, options)\n//  * - path starts with '/items' or '/cart' or '/users/...' (no /api prefix)\n//  * - options: fetch init (method, headers, body)\n//  */\n// export default async function API(path, options = {}) {\n//   const url = `${API_BASE}${path}`;\n//   const headers = {\n//     \"Content-Type\": \"application/json\",\n//     ...(options.headers || {}),\n//   };\n\n//   // keep token automatically (if present)\n//   if (!headers.Authorization) {\n//     const token = localStorage.getItem(\"token\");\n//     if (token) headers.Authorization = `Bearer ${token}`;\n//   }\n\n//   const fetchOpts = { headers, ...options };\n//   try {\n//     const res = await fetch(url, fetchOpts);\n//     // if server returns not-json (HTML error) throw with text\n//     const text = await res.text();\n//     try {\n//       const json = JSON.parse(text || \"{}\");\n//       if (!res.ok) throw new Error(json.message || `Server error ${res.status}`);\n//       return json;\n//     } catch {\n//       // not json\n//       if (!res.ok) throw new Error(text || `Server error ${res.status}`);\n//       // if ok but not json return text\n//       return text;\n//     }\n//   } catch (err) {\n//     console.error(\"API error:\", err);\n//     throw err;\n//   }\n// }\n\n// ‚úÖ frontend/src/api.js\nconst API_BASE = (process.env.REACT_APP_API_URL || \"http://localhost:5000/api\").replace(/\\/+$/, \"\");\n\nexport default async function API(path, options = {}) {\n  // Always prefix with /api\n  const endpoint = path.startsWith(\"/api\") ? path : path.startsWith(\"/\") ? `/api${path}` : `/api/${path}`;\n  const url = `${API_BASE}${endpoint.replace(\"/api/api\", \"/api\")}`;\n\n  const headers = {\n    \"Content-Type\": \"application/json\",\n    ...(options.headers || {}),\n  };\n\n  const token = localStorage.getItem(\"token\");\n  if (token && !headers.Authorization) {\n    headers.Authorization = `Bearer ${token}`;\n  }\n\n  console.log(\"üåê API Request:\", url); // üëà helpful debug log\n\n  try {\n    const res = await fetch(url, { ...options, headers });\n    const text = await res.text();\n\n    try {\n      const data = JSON.parse(text);\n      if (!res.ok) throw new Error(data.message || `HTTP ${res.status}`);\n      return data;\n    } catch {\n      throw new Error(`Server error ${res.status}: ${text}`);\n    }\n  } catch (err) {\n    console.error(\"‚ùå API error:\", err);\n    throw err;\n  }\n}\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAMA,QAAQ,GAAG,CAACC,OAAO,CAACC,GAAG,CAACC,iBAAiB,IAAI,2BAA2B,EAAEC,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC;AAEnG,eAAe,eAAeC,GAAGA,CAACC,IAAI,EAAEC,OAAO,GAAG,CAAC,CAAC,EAAE;EACpD;EACA,MAAMC,QAAQ,GAAGF,IAAI,CAACG,UAAU,CAAC,MAAM,CAAC,GAAGH,IAAI,GAAGA,IAAI,CAACG,UAAU,CAAC,GAAG,CAAC,GAAG,OAAOH,IAAI,EAAE,GAAG,QAAQA,IAAI,EAAE;EACvG,MAAMI,GAAG,GAAG,GAAGV,QAAQ,GAAGQ,QAAQ,CAACJ,OAAO,CAAC,UAAU,EAAE,MAAM,CAAC,EAAE;EAEhE,MAAMO,OAAO,GAAG;IACd,cAAc,EAAE,kBAAkB;IAClC,IAAIJ,OAAO,CAACI,OAAO,IAAI,CAAC,CAAC;EAC3B,CAAC;EAED,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;EAC3C,IAAIF,KAAK,IAAI,CAACD,OAAO,CAACI,aAAa,EAAE;IACnCJ,OAAO,CAACI,aAAa,GAAG,UAAUH,KAAK,EAAE;EAC3C;EAEAI,OAAO,CAACC,GAAG,CAAC,iBAAiB,EAAEP,GAAG,CAAC,CAAC,CAAC;;EAErC,IAAI;IACF,MAAMQ,GAAG,GAAG,MAAMC,KAAK,CAACT,GAAG,EAAE;MAAE,GAAGH,OAAO;MAAEI;IAAQ,CAAC,CAAC;IACrD,MAAMS,IAAI,GAAG,MAAMF,GAAG,CAACE,IAAI,CAAC,CAAC;IAE7B,IAAI;MACF,MAAMC,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACH,IAAI,CAAC;MAC7B,IAAI,CAACF,GAAG,CAACM,EAAE,EAAE,MAAM,IAAIC,KAAK,CAACJ,IAAI,CAACK,OAAO,IAAI,QAAQR,GAAG,CAACS,MAAM,EAAE,CAAC;MAClE,OAAON,IAAI;IACb,CAAC,CAAC,MAAM;MACN,MAAM,IAAII,KAAK,CAAC,gBAAgBP,GAAG,CAACS,MAAM,KAAKP,IAAI,EAAE,CAAC;IACxD;EACF,CAAC,CAAC,OAAOQ,GAAG,EAAE;IACZZ,OAAO,CAACa,KAAK,CAAC,cAAc,EAAED,GAAG,CAAC;IAClC,MAAMA,GAAG;EACX;AACF;AAACE,EAAA,GAhC6BzB,GAAG;AAAA,IAAAyB,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}